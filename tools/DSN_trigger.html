<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>ğŸ”¬ DSN Analysis</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="Cache-Control" content="no-store, max-age=0" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <style>
    :root { --primary:#007bff; --accent:#87CEFA; --ok:#2e7d32; --warn:#c62828; --barbg:#edf2f7; }
    body{font:16px/1.35 -apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,sans-serif;margin:24px;max-width:900px}
    h1{margin:0 0 8px 0}
    .muted{opacity:.75}
    .row{margin:10px 0}
    .btn{display:inline-block;padding:8px 12px;border-radius:8px;border:1px solid #ccc;text-decoration:none}
    .btn[disabled]{opacity:.4;pointer-events:none}
    #barwrap{height:10px;background:var(--barbg);border-radius:999px;overflow:hidden;margin:12px 0 4px 0;box-shadow:inset 0 0 0 1px #e2e8f0}
    #bar{height:100%;width:0%;background:linear-gradient(90deg,#69c,#38bdf8 40%,#22c55e 75%,#16a34a 100%);transition:width .5s ease}
    #bar.timeout{background:linear-gradient(90deg,#f59e0b,#ef4444)}
    #status{margin:8px 0;min-height:2.2em}
    #controls a{margin-right:10px}
    details{border:1px solid #e5e7eb;border-radius:8px;padding:.5rem 1rem;background:#fafafa}
    details pre{white-space:pre-wrap;word-break:break-word;background:#fff;border:1px solid #eee;border-radius:6px;padding:.75rem;max-height:260px;overflow:auto}
    code{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,monospace}
    .done{border:1px solid #dcfce7;background:#f0fdf4;border-radius:10px;padding:12px;margin-top:16px}
    .badge{display:inline-block;padding:.15rem .45rem;border-radius:6px;border:1px solid #e5e7eb;background:#f8fafc;font-size:.9rem}
  </style>
</head>
<body>
  <h1 id="title">ğŸ”¬ DSN Analysis</h1>
  <div id="header" class="muted">â³ Initializingâ€¦ 2 <span id="jsBadge" class="badge">JS: starting</span></div>
  <div id="barwrap"><div id="bar"></div></div>
  <div class="row" id="status">Preparingâ€¦</div>
  <div class="row">
    <span id="elapsed">0:00</span>
    <span class="muted"> Â· Timeout in <span id="timeoutLeft">7:00</span></span>
  </div>
  <div id="controls" class="row">
    <a id="viewBtn" class="btn" href="#" target="_blank" rel="noopener" disabled>ğŸ“„ View Analysis Result</a>
    <a id="exitBtn" class="btn" href="about:blank">ğŸ”™ Exit</a>
  </div>
  <details id="debug">
    <summary>ğŸ”§ Debug</summary>
    <div><strong>Params</strong>: <code id="dbgParams"></code></div>
    <div><strong>Webhook base</strong>: <code id="dbgHook"></code></div>
    <div><strong>Health checks</strong>:</div>
    <pre id="dbgHealth">(pending)</pre>
    <div><strong>POST result</strong>:</div>
    <pre id="dbgPost">(pending)</pre>
    <div><strong>Status polls</strong>:</div>
    <pre id="dbgPolls">(pending)</pre>
    <div><strong>Errors</strong>:</div>
    <pre id="dbgErrors">(none)</pre>
  </details>
  <script>
  // same JS logic as before (omitted here for brevity, identical to DSN_trigger.v7.html provided earlier)
  </script>
</body>
</html>
